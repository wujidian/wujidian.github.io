(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{53370:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/parkFootprint",function(){return c(34011)}])},34011:function(d,b,a){"use strict";a.r(b),a.d(b,{default:function(){return y}});var e=a(47568),f=a(10797),c=a(34051),g=a.n(c),h=a(85893),i=a(64987),j=a(1787),k=a(37234),l=a(3261),m=a(67294),n=function(a){var e=a.longitude,f=a.latitude,g=a.title,j=function(){var a=new TMap.LatLng(f,e),b=new TMap.Map(document.getElementById("mapRef"),{disableDefaultUI:!0,center:a,zoom:16,baseMap:{type:"satellite",features:["base","building2d"]}}),c=new TMap.MultiMarker({map:b,enableDefaultStyle:!1,styles:{myStyle:new TMap.MarkerStyle({width:20,height:30,anchor:{x:10,y:30},src:"/images/mark.png",size:16,color:"#333",strokeWidth:2,strokeColor:"#fff",direction:"bottom"})},geometries:[{position:a,id:"1",styleId:"myStyle",content:g},]});l(b),o(c)},b=(0,m.useState)("321123");b[0],b[1];var i=(0,m.useRef)(null),c=(0,m.useState)(null),k=c[0],l=c[1],d=(0,m.useState)(null),n=d[0],o=d[1];return(0,m.useEffect)(function(){j()},[]),(0,m.useEffect)(function(){if(null!=n&&null!=k){var a=new TMap.LatLng(f,e);k.setCenter(a),n.setGeometries([{position:a,id:"1",styleId:"myStyle",content:g}])}},[e,f,g]),(0,h.jsx)("div",{id:"mapRef",className:"Mymap",ref:i})},o=a(20482),p=a(13819),q=a(11163),r=a(78676),s=a(76109),t=a(98542),u=a(11588),v=a(82071),w=a(32808),x=a(82051),y=function(){var T,U,V,W,X,Y,ai=(0,q.useRouter)(),Z=t.Z.RangePicker,c=(0,m.useContext)(s.I),$=c.state,aj=c.dispatch,b=$.parkId,d=(0,m.useState)(!1),_=d[0],ak=d[1],y=(0,m.useState)(!1),z=y[0],al=y[1],A=(0,m.useState)(""),am=A[0],an=A[1],B=(0,m.useState)(""),ao=B[0],ap=B[1],C=(0,m.useState)([]),aa=C[0],aq=C[1],D=(0,m.useState)(!0),E=D[0],ar=D[1],F=(0,m.useState)(!0),ab=F[0],as=F[1],G=(0,m.useState)(!0),ac=G[0],at=G[1],H=(0,m.useState)("1"),I=H[0],au=H[1],J=(0,m.useState)({id:0,name:"\u6682\u65E0\u4FE1\u606F",area:"",num:0,address:"\u6682\u65E0\u4FE1\u606F",emissionLoad:"0",region:"\u6682\u65E0\u4FE1\u606F",type:"\u6682\u65E0\u4FE1\u606F",reduce:"0.00",location:{coordinates:[0,0],type:"Point"}}),a=J[0],av=J[1],K=(0,m.useState)([{id:0,title:"\u6682\u65E0\u6D88\u606F",iconImg:"/images/Group.png",time:"\u6682\u65E0\u4FE1\u606F",emissions:"0.00"},]),L=K[0],aw=K[1],M=(0,m.useState)([]),ad=M[0],ax=M[1],N=(0,m.useState)([]),ae=N[0],ay=N[1],O=(0,m.useState)([]),af=O[0],az=O[1],P=(0,m.useState)([]),ag=P[0],aA=P[1],Q=(0,m.useState)({latitude:30.572961,longitude:104.066301}),R=Q[0],aB=Q[1],S=(0,m.useState)({}),ah=S[0],aC=S[1],aD=(T=(0,e.Z)(g().mark(function a(b){var c;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,(0,r.KT)(b);case 3:aC((c=a.sent).data),al(!0),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),u.ZP.error("\u67E5\u770B\u8BB0\u5F55\u5931\u8D25,\u8BF7\u7A0D\u540E\u91CD\u8BD5");case 11:case"end":return a.stop()}},a,null,[[0,8]])})),function(a){return T.apply(this,arguments)}),aE=(U=(0,e.Z)(g().mark(function a(){var c;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(0!==aa.length){a.next=3;break}return u.ZP.error("\u8BF7\u9009\u62E9\u62A5\u8868\u7C7B\u578B"),a.abrupt("return");case 3:if(!(!am||!ao)){a.next=6;break}return u.ZP.error("\u8BF7\u9009\u62E9\u65E5\u671F"),a.abrupt("return");case 6:return ak(!1),a.next=9,(0,r.GU)(b,{startTime:am,endTime:ao,activityId:aa.join(",")});case 9:aC((c=a.sent).data),al(!0);case 12:case"end":return a.stop()}},a)})),function(){return U.apply(this,arguments)}),aF=function(a){aj({type:"UPDATE_PARK_FOOTPRINT_INFO_ID",payload:a}),ai.push("/parkFootprint/info")},aG=(V=(0,e.Z)(g().mark(function a(b){var c;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return ar(!1),a.prev=1,a.next=4,(0,r.dC)(b);case 4:av((c=a.sent).data),aB({latitude:c.data.location.coordinates[1],longitude:c.data.location.coordinates[0]}),a.next=11;break;case 9:a.prev=9,a.t0=a.catch(1);case 11:ar(!0);case 12:case"end":return a.stop()}},a,null,[[1,9]])})),function(a){return V.apply(this,arguments)}),aH=(W=(0,e.Z)(g().mark(function a(b,c){var d,e,h,i;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return as(!1),a.prev=1,a.next=4,(0,r.rX)(b,c);case 4:d=a.sent,e=[],h=[],i=[],d.data.forEach(function(a){e.push(a.startTime),h.push(a.carbonEquivalent),i.push(a.emissionLoad)}),ay((0,f.Z)(e)),az((0,f.Z)(h)),aA((0,f.Z)(i)),a.next=16;break;case 14:a.prev=14,a.t0=a.catch(1);case 16:as(!0);case 17:case"end":return a.stop()}},a,null,[[1,14]])})),function(a,b){return W.apply(this,arguments)}),aI=(X=(0,e.Z)(g().mark(function a(b){var c,d;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return at(!1),a.prev=1,a.next=4,(0,r.Fe)(b);case 4:d=(c=a.sent).data.map(function(a){return{id:a.id,title:a.name,emissions:a.emissionLoad,time:a.startTime,iconImg:"/images/Group.png"}}),aw((0,f.Z)(d)),a.next=11;break;case 9:a.prev=9,a.t0=a.catch(1);case 11:at(!0);case 12:case"end":return a.stop()}},a,null,[[1,9]])})),function(a){return X.apply(this,arguments)}),aJ=(Y=(0,e.Z)(g().mark(function a(b){var c,d;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,(0,r.PA)(b);case 3:d=(c=a.sent).data.reverse(),ax((0,f.Z)(d)),a.next=10;break;case 8:a.prev=8,a.t0=a.catch(0);case 10:case"end":return a.stop()}},a,null,[[0,8]])})),function(a){return Y.apply(this,arguments)});return(0,m.useEffect)(function(){b&&(aG(b),aI(b))},[b]),(0,m.useEffect)(function(){aH(b,I)},[b,I]),(0,m.useEffect)(function(){aJ(b)},[b,z]),(0,h.jsxs)("div",{className:"parkFootprint",children:[(0,h.jsxs)("div",{className:"topCardBox",children:[(0,h.jsx)("div",{className:"parkcard-box",children:E?(0,h.jsx)(k.Z,{parkName:a.name,parkLoc:a.address,parktype:a.type,parknum:a.num,area:a.area}):(0,h.jsx)(o.Z,{})}),(0,h.jsx)("div",{className:"TotalCount-box",children:E?(0,h.jsx)(l.Z,{title:"".concat(3==a.id?"\u6797\u533A\u672C\u5E74\u5EA6\u7D2F\u8BA1\u78B3\u4FE1\u7528\u603B\u91CF":"\u56ED\u533A\u672C\u5E74\u5EA6\u78B3\u6392\u653E\u603B\u91CF"),total:a.emissionLoad,addOrsub:!1,deviation:a.reduce}):(0,h.jsx)(o.Z,{})})]}),(0,h.jsx)("div",{className:"lineChartBox",children:ab?(0,h.jsx)(i.Z,{park_name:"".concat(3==a.id?"\u6797\u533A":"\u56ED\u533A","\u78B3\u8DB3\u8FF9"),toDay_data:0,park_xAxisData:ae,park_carbonEquivalent:af,park_emissionLoad:ag,setTimeType:function(a){return au(a)},timeType:I}):(0,h.jsx)(o.Z,{rows:8})}),"\u6682\u65E0\u4FE1\u606F"!==a.name?(0,h.jsx)(n,{longitude:R.longitude,latitude:R.latitude,title:a.name}):(0,h.jsx)(o.Z,{rows:8}),(0,h.jsx)("div",{children:ac?(0,h.jsx)("div",{children:L.map(function(a,c){return(0,h.jsx)(j.Z,{id:a.id,linkFun:function(){return aF(a.id)},time:a.time,title:a.title,iconImg:a.iconImg,emissions:a.emissions,dataTitle:3==b?"\u78B3\u6C47\u91CF":"\u78B3\u6392\u653E\u91CF"},c.toString())})}):(0,h.jsx)(o.Z,{rows:8})}),(0,h.jsxs)("div",{className:"m24 flex jcsbcentennt",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("span",{className:"pageTitle",children:"".concat(3==a.id?"\u6797\u533A":"\u56ED\u533A","\u78B3\u6838\u7B97\u62A5\u544A")}),(0,h.jsx)("span",{className:"mr5",children:" \u751F\u6210\u4F9D\u636E "}),(0,h.jsx)("span",{className:"blueTip",children:3==b?"\u300A\u6797\u4E1A\u78B3\u6C47\u9879\u76EE\u5BA1\u5B9A\u548C\u6838\u8BC1\u6307\u5357\u300BGB/T 41198-2021":"\u300A\u4F01\u4E1A\u6E29\u5BA4\u6C14\u4F53\u6392\u653E\u6838\u7B97\u65B9\u6CD5\u4E0E\u62A5\u544A\u6307\u5357\u300B"})]}),(0,h.jsx)("button",{className:"viewRecords",onClick:function(){return ak(!0)},children:"\u751F\u6210\u62A5\u544A"})]}),(0,h.jsx)("div",{children:ad.map(function(a,b){return(0,h.jsx)(j.Z,{id:a.id,time:a.create_time,title:a.name,iconImg:"/images/Group.png",type:a.activity_name,appendButto:(0,h.jsx)(x.Z,{btnText:"\u67E5\u770B\u62A5\u544A",btnClickFun:function(){aD(a.id)}})},b.toString())})}),(0,h.jsxs)(v.Z,{title:"\u9009\u62E9\u62A5\u544A",visible:_,onOk:function(){aE()},onCancel:function(){return ak(!1)},cancelText:"\u53D6\u6D88",okText:"\u786E\u5B9A",children:[(0,h.jsx)("div",{style:{margin:"0 0 40px 0"},children:(0,h.jsx)(w.Z.Group,{options:L.map(function(a,b){return{label:a.title,value:a.id}}),defaultValue:aa,onChange:function(a){aq(a)}})}),(0,h.jsx)(Z,{format:"YYYY/MM/DD",onChange:function(a){a?(an(a[0].format("YYYY-MM-DD")),ap(a[1].format("YYYY-MM-DD"))):(an(""),ap(""))}})]}),(0,h.jsx)(p.Z,{pdfShow:z,onCancel:function(){return al(!1)},pdfParkInfo:ah})]})}}},function(a){a.O(0,[443,847,885,421,220,711,551,774,888,179],function(){var b;return a(a.s=53370)}),_N_E=a.O()}])